<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tienda Las Manzanitas</title>
</head>
<body>

    <script>
        // ========== MODELO ==========

        // Clase padre Producto
        class Producto {
            constructor(id, nombre, precio, stock, categoria) {
                this.id = id;
                this.nombre = nombre;
                this.precio = precio;
                this.stock = stock;
                this.categoria = categoria;
            }

            // Método para obtener información básica del producto
            obtenerInfo() {
                return `${this.nombre} : $ ${this.precio.toFixed(2)}`;
            }

            // Método para verificar disponibilidad
            estaDisponible(cantidad =1) {
                return this.stock>=cantidad;
                
            }

            // Método para reducir stock
            reducirStock(cantidad = 1) {
                if(this.estaDisponible(cantidad)){
                    this.stock-=cantidad;
                    return true;
                }
                return false;
            }

            // Método para aumentar stock
            aumentarStock(cantidad =1) {
                this.stock+=cantidad;
            }
        }

        // Clase hija Fruta que hereda de Producto
        class Fruta extends Producto {
            constructor(id, nombre, precio, stock, categoria, temporada, origen) {
                super(id, nombre, precio, stock, categoria);
                this.temporada = temporada;
                this.origen = origen;
            }

            // Polimorfismo: Sobrescribimos el método obtenerInfo
            obtenerInfo() {
               return `${this.nombre} : $ ${this.precio.toFixed(2)} (${this.temporada})`;
            }

            // Método específico para frutas
            esDeTemporada() {
                const mesActual = new Date().getMonth()+1;
                return this.temporada.includes(mesActual);
            }
        }

        // Clase para el carrito de compras
        class Carrito {
            constructor() {
                this.items = [];
            }

            // Agregar producto al carrito
            agregarProducto(producto, cantidad = 1) {
                const itemExist = this.items.find(item=>item.producto.id===producto.id);
                if(itemExist){
                    itemExist.cantidad+=cantidad;
                } else {
                    this.items.push({
                        producto:producto,
                        cantidad:cantidad
                    });
                }
            }

            // Eliminar producto del carrito
            eliminarProducto(id) {
                this.items=this.items.filter(item=> item.producto.id !==id);

            }

            // Actualizar cantidad de un producto
            actualizarCantidad(id, cantidad) {
                const item = this.items.find(item => item.producto.id===id);
                if(item){
                    if(cantidad<=0){
                        this.eliminarProducto(id);
                    } else {
                        item.cantidad=cantidad;
                    }
                }
            }

            // Calcular el total del carrito
            calcularTotal() {
                return this.items.reduce((total, item)=>{
                    return total+(item.producto.precio * item.producto.cantidad);
                },0);
            }

            // Vaciar el carrito
            vaciar() {
                this.items=[];
            }

            // Realizar compra (reducir stock de productos)
            realizarCompra() {
                const productosSinStock=[];

                this.items.forEach( item =>{
                    if(!item.producto.estaDisponible(item.cantidad)){
                        productosSinStock.push(item.producto.nombre);
                    }
                });

                if(productosSinStock.length>0){
                    return{
                        exito:false,
                        mensaje:`No hay suficiente stock para: ${productosSinStock.join(', ')}`,
                        total:total
                    }
                }

            }
        }

        // Clase para gestionar el inventario
        class Inventario {
            constructor() {
                this.productos = [];
                this.cargarProductosIniciales();
            }

            // Cargar productos de ejemplo
            cargarProductosIniciales() {
                this.productos=[
                    new Fruta(1,"Manzana Roja",48.50,50,"frutilla",[9,10,11,12],"Argentina"),
                    new Fruta(2, "Platano Chiapas",17.40,100,'tropical',[1,2,3,4,5,6,7,8,9,10,11,12],"México"),
                    new Fruta(3, "Naranja", 1.50, 30, "citrico", [5, 6, 7, 8, 9, 10], "España"),
                    new Fruta(4, "Fresa", 2.50, 20, "frutilla", [3, 4, 5, 6], "México"),
                    new Fruta(5, "Piña", 3.00, 15, "tropical", [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "Costa Rica"),
                    new Fruta(6, "Limón", 1.00, 40, "citrico", [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "Argentina"),
                    new Fruta(7, "Uva", 2.20, 25, "frutilla", [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "Chile"),
                    new Fruta(8, "Mango Ataúlfo", 2.80, 18, "tropical", [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "México"),
                    new Fruta(9, "Pera", 1.70, 35, "frutilla", [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "Argentina"),
                    new Fruta(10, "Kiwi", 2.10, 22, "frutilla", [3, 4, 5, 6, 7, 8, 9], "Nueva Zelanda")


                ];
            }

            // Obtener todos los productos
            obtenerProductos() {
                
            }

            // Obtener productos por categoría
            obtenerProductosPorCategoria() {
                
            }

            // Buscar producto por ID
            obtenerProductoPorId() {
                
            }
        }

        // ========== VISTA ==========

        class Vista {
            constructor() {
                
            }

            // Mostrar productos en la interfaz
            mostrarProductos(productos) {
                
            }

            // Mostrar items del carrito
            mostrarCarrito(carrito) {
                
            }

            // Mostrar mensaje al usuario
            mostrarMensaje() {
                
            }

            // Actualizar filtros activos
            actualizarFiltros() {
                
            }
        }

        // ========== CONTROLADOR ==========

        class Controlador {
            constructor(modelo, vista) {
                this.modelo = modelo;
                this.vista = vista;
                this.carrito = new Carrito();
                
                this.inicializarEventos();
                this.cargarProductos();
            }

            // Inicializar eventos de la interfaz
            inicializarEventos() {
                
            }

            // Cargar productos en la vista
            cargarProductos() {
            }

            // Filtrar productos por categoría
            filtrarProductos(categoria) {
                
            }

            // Agregar producto al carrito
            agregarAlCarrito() {

            }

            // Eliminar producto del carrito
            eliminarDelCarrito() {
                
            }

            // Modificar cantidad de producto en el carrito
            modificarCantidad() {
                
            }

            // Realizar compra
            realizarCompra() {

            }
        }

    </script>
</body>
</html>