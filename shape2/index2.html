<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shapes</title>
    <script src="shape.js"></script>
    <style>
        #container {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        #rulers {
            display: flex;
            flex-direction: row;
        }
        #ruler-y {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            height: 400px;
            margin-right: 2px;
            font-size: 10px;
            user-select: none;
        }
        #ruler-x {
            display: flex;
            flex-direction: row;
            width: 400px;
            margin-bottom: 2px;
            font-size: 10px;
            user-select: none;
        }
        #canvas {
            width: 400px;
            height: 400px;
            border: 1px solid #333;
            position: relative;
            background: #f9f9f9;
        }
        .shape {
            position: absolute;
        }
        .tick-x, .tick-y {
            color: #555;
            opacity: 0.7;
        }
        .tick-x {
            width: 20px;
            text-align: center;
        }
        .tick-y {
            height: 20px;
            line-height: 20px;
        }
    </style>
</head>
<body>
    <form id="shapeForm">
        <label>Figura:
            <select id="shapeType" name="shapeType">
                <option value="Circle">Círculo</option>
                <option value="Square">Cuadrado</option>
                <option value="Triangle">Triángulo</option>
            </select>
        </label>
        <span id="inputs"></span>
        <button type="submit">Crear</button>
        <button type="button" id="clearBtn">Limpiar Canvas</button>
    </form>
    <div id="container">
        <div id="ruler-x"></div>
        <div id="rulers">
            <div id="ruler-y"></div>
            <div id="canvas"></div>
        </div>
    </div>
    <script>
        // Generar inputs dinámicos según la figura
        const inputsDiv = document.getElementById('inputs');
        const shapeType = document.getElementById('shapeType');
        function updateInputs() {
            let html = '';
            if (shapeType.value === 'Circle') {
                html = 'Radio: <input name="r" type="number" min="1" required> ';
            } else if (shapeType.value === 'Square') {
                html = 'Lado: <input name="l" type="number" min="1" required> ';
            } else if (shapeType.value === 'Triangle') {
                html = 'Base: <input name="b" type="number" min="1" required> ';
                html += 'Altura: <input name="h" type="number" min="1" required> ';
            }
            html += 'X: <input name="x" type="number" min="0" max="380" required> ';
            html += 'Y: <input name="y" type="number" min="0" max="380" required> ';
            html += 'Color: <input name="color" type="color" value="#ff0000" required> ';
            inputsDiv.innerHTML = html;
        }
        shapeType.addEventListener('change', updateInputs);
        updateInputs();

        // Dibuja la figura en el canvas usando CSS
        function drawShape(shapeObj, type) {
            const canvas = document.getElementById('canvas');
            const div = document.createElement('div');
            div.className = 'shape';
            div.style.left = shapeObj.x + 'px';
            div.style.top = shapeObj.y + 'px';
            div.style.background = shapeObj.color;

            if (type === 'Circle') {
                div.style.width = (shapeObj.r * 2) + 'px';
                div.style.height = (shapeObj.r * 2) + 'px';
                div.style.borderRadius = '50%';
            } else if (type === 'Square') {
                div.style.width = shapeObj.l + 'px';
                div.style.height = shapeObj.l + 'px';
            } else if (type === 'Triangle') {
                div.style.width = '0';
                div.style.height = '0';
                div.style.borderLeft = (shapeObj.b / 2) + 'px solid transparent';
                div.style.borderRight = (shapeObj.b / 2) + 'px solid transparent';
                div.style.borderBottom = shapeObj.h + 'px solid ' + shapeObj.color;
                div.style.background = 'none';
            }
            canvas.appendChild(div);
        }

        // Maneja el formulario y crea la figura usando las clases de shape.js
        document.getElementById('shapeForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const data = new FormData(e.target);
            const type = data.get('shapeType');
            let shapeObj;
            if (type === 'Circle') {
                shapeObj = new Circle(
                    Number(data.get('r')),
                    Number(data.get('x')),
                    Number(data.get('y')),
                    data.get('color')
                );
            } else if (type === 'Square') {
                shapeObj = new Square(
                    Number(data.get('l')),
                    Number(data.get('x')),
                    Number(data.get('y')),
                    data.get('color')
                );
            } else if (type === 'Triangle') {
                shapeObj = new Triangle(
                    Number(data.get('b')),
                    Number(data.get('h')),
                    Number(data.get('x')),
                    Number(data.get('y')),
                    data.get('color')
                );
            }
            if (shapeObj) {
                drawShape(shapeObj, type);
                shapeObj.area(); // Muestra el área en consola
                shapeObj.posicion(); // Muestra la posición en consola
            }
        });

        // Limpiar el canvas
        document.getElementById('clearBtn').addEventListener('click', function() {
            document.getElementById('canvas').innerHTML = '';
        });

        // Crear figura con click en el canvas
        document.getElementById('canvas').addEventListener('click', function(e) {
            const rect = this.getBoundingClientRect();
            const x = Math.round(e.clientX - rect.left);
            const y = Math.round(e.clientY - rect.top);

            // Obtener valores del formulario
            const data = new FormData(document.getElementById('shapeForm'));
            const type = data.get('shapeType');
            let valid = true;
            let shapeObj;

            if (type === 'Circle') {
                if (!data.get('r')) valid = false;
                shapeObj = new Circle(
                    Number(data.get('r')),
                    x,
                    y,
                    data.get('color')
                );
            } else if (type === 'Square') {
                if (!data.get('l')) valid = false;
                shapeObj = new Square(
                    Number(data.get('l')),
                    x,
                    y,
                    data.get('color')
                );
            } else if (type === 'Triangle') {
                if (!data.get('b') || !data.get('h')) valid = false;
                shapeObj = new Triangle(
                    Number(data.get('b')),
                    Number(data.get('h')),
                    x,
                    y,
                    data.get('color')
                );
            }
            // Solo si los valores requeridos existen
            if (valid && shapeObj) {
                drawShape(shapeObj, type);
                shapeObj.area();
                shapeObj.posicion();
            }
        });

        // Dibujar reglas
        function drawRulers() {
            const rulerX = document.getElementById('ruler-x');
            const rulerY = document.getElementById('ruler-y');
            rulerX.innerHTML = '';
            rulerY.innerHTML = '';
            for (let i = 0; i <= 400; i += 10) {
                const tickX = document.createElement('div');
                tickX.className = 'tick-x';
                tickX.style.display = 'inline-block';
                tickX.style.width = '20px';
                tickX.textContent = i % 50 === 0 ? i : '|';
                rulerX.appendChild(tickX);

                const tickY = document.createElement('div');
                tickY.className = 'tick-y';
                tickY.style.height = '20px';
                tickY.textContent = i % 50 === 0 ? i : '—';
                rulerY.appendChild(tickY);
            }
        }
        drawRulers();
    </script>
</body>
</html>